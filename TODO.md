# ‚úÖ TODO - Tarefas T√©cnicas

> **SINCRONIZADO COM**: [ROADMAP.md](./ROADMAP.md)  
> Este documento cont√©m detalhes t√©cnicos de implementa√ß√£o das features planejadas no roadmap.

---

## üìç Status Atual: v3.1.0 (Released) ‚Üí v3.2.0 (Pr√≥xima)

---

## ‚úÖ v3.1.0 - Pipeline Resiliente + Testes (CONCLU√çDA - 2025-10-17)

> üìã **Vis√£o geral**: Ver [ROADMAP.md - v3.1.0](./ROADMAP.md#v310---pipeline-resiliente-planejado)

### Checkpoints e Salvamento Incremental
- [x] ‚úÖ Implementar `CheckpointManager` em `adalove_extractor/io/checkpoint.py`
  - M√©todos: `save()`, `load()`, `resume()`, `cleanup()`
  - Schema: JSON com metadata + dados
  - Valida√ß√£o de integridade com checksums
  
- [x] ‚úÖ Adicionar `IncrementalWriter` em `adalove_extractor/io/incremental_writer.py`
  - Modo append-only para JSONL
  - Flush autom√°tico a cada N cards
  - Valida√ß√£o de integridade com checksums
  - Backup por semana em `checkpoint_semana_XX.json`

- [x] ‚úÖ Criar `RecoveryManager` para detec√ß√£o e retomada
  - Scan de checkpoints √≥rf√£os
  - Interface interativa para retomada
  - Merge de dados de m√∫ltiplas execu√ß√µes
  - Detec√ß√£o autom√°tica na inicializa√ß√£o

### Processamento Streaming
- [x] ‚úÖ Refatorar extractors para async generators
  - `extract_cards() -> AsyncIterator[Card]`
  - Yield cards conforme extra√≠dos
  - Reduzir uso de mem√≥ria
  - Processamento incremental

### Testes B√°sicos de Robustez
- [x] ‚úÖ Setup pytest + pytest-asyncio
  - Configurar `pyproject.toml`
  - Criar estrutura `tests/`
  - Meta de cobertura: >70% nos m√≥dulos cr√≠ticos

- [x] ‚úÖ Testes para checkpoints
  - `tests/test_checkpoint_manager.py`
  - `tests/test_incremental_writer.py`
  - `tests/test_recovery_manager.py`
  - Fixtures com estados simulados

- [x] ‚úÖ Testes de integra√ß√£o
  - `tests/test_integration_checkpoint_flow.py`
  - Simula√ß√£o de interrup√ß√£o e recupera√ß√£o
  - Valida√ß√£o de fluxo completo

### Valida√ß√£o e Idempot√™ncia
- [x] ‚úÖ Implementar valida√ß√£o de integridade
  - Checksums para arquivos de checkpoint
  - Valida√ß√£o de estrutura JSON
  - Detec√ß√£o de corrup√ß√£o de dados

- [x] ‚úÖ Sistema de idempot√™ncia
  - Detec√ß√£o de duplicatas baseada em conte√∫do
  - Merge inteligente de dados de m√∫ltiplas execu√ß√µes
  - Consolida√ß√£o de dados tempor√°rios

### Integra√ß√£o no CLI
- [x] ‚úÖ Integrar sistema resiliente no `cli/main.py`
  - Detec√ß√£o autom√°tica de execu√ß√µes interrompidas
  - Prompt interativo para recupera√ß√£o
  - Salvamento incremental ap√≥s cada semana
  - Tratamento de erros com checkpoint de falha

### Resultados Finais
- [x] ‚úÖ **41 testes** passando (100% de sucesso)
- [x] ‚úÖ **Cobertura >70%** nos m√≥dulos cr√≠ticos
- [x] ‚úÖ **Sistema resiliente** funcionando perfeitamente
- [x] ‚úÖ **Problema de perda de dados** completamente resolvido
  - Valida√ß√£o de integridade

- [ ] Testes para salvamento incremental
  - `tests/test_incremental_writer.py`
  - Verificar append-only
  - Valida√ß√£o de integridade
  - Testar flush autom√°tico

- [ ] Testes de recupera√ß√£o
  - `tests/test_recovery_manager.py`
  - Simular falhas em pontos cr√≠ticos
  - Verificar retomada correta
  - Testar merge de dados

### Valida√ß√£o e Idempot√™ncia
- [ ] Implementar hash-based deduplication
  - Manter mapa persistente de hashes processados
  - Skip de cards j√° extra√≠dos
  - Op√ß√£o: `--force-reextract` para ignorar cache
- [ ] Valida√ß√£o de estrutura JSON em checkpoints
- [ ] Contadores e checksums para integridade
- [ ] Limpeza autom√°tica de checkpoints antigos

---

## üìã v3.1.2 - Quick Wins e UX (Planned - Q4 2025)

> üìã **Vis√£o geral**: Ver [ROADMAP.md - v3.1.2](./ROADMAP.md#v312---quick-wins-e-melhorias-ux-planejado)

### Barra de Progresso
- [ ] Adicionar `tqdm` √†s dependencies
- [ ] Integrar em `cli/main.py`
  - Progresso por semana
  - Progresso global
  - ETA e velocidade
  - Cards/minuto

### Modo Dry-Run
- [ ] Flag `--dry-run` em CLI
- [ ] Simular extra√ß√£o sem I/O
- [ ] Exibir estat√≠sticas estimadas
- [ ] Valida√ß√£o de configura√ß√µes

### Verbosidade Configur√°vel
- [ ] Flags `-v`, `-vv`, `-vvv`
- [ ] N√≠veis de log din√¢micos
- [ ] Debug detalhado em modo verbose
- [ ] Configura√ß√£o por m√≥dulo

### Comando Version
- [ ] Implementar `adalove --version`
- [ ] Exibir: vers√£o, Python, Playwright
- [ ] Informa√ß√µes do sistema
- [ ] Depend√™ncias principais

---

## üîß v3.1.3 - Infraestrutura CI/CD (Planned - Q4 2025)

> üìã **Vis√£o geral**: Ver [ROADMAP.md - v3.1.3](./ROADMAP.md#v313---infraestrutura-e-cicd-planejado)

### GitHub Actions
- [ ] Criar `.github/workflows/test.yml`
  - Matrix: Python 3.11, 3.12
  - Steps: install, lint, test, coverage
  - Cache de depend√™ncias
  - Relat√≥rios de cobertura

- [ ] Criar `.github/workflows/release.yml`
  - Build e publish no PyPI
  - Changelog autom√°tico
  - Versionamento sem√¢ntico

### Pre-commit Hooks
- [ ] Criar `.pre-commit-config.yaml`
- [ ] Configurar: black, isort, flake8, mypy
- [ ] Documentar setup em CONTRIBUTING.md
- [ ] Instala√ß√£o: `pre-commit install`

### Dependabot
- [ ] Criar `.github/dependabot.yml`
- [ ] Schedule semanal
- [ ] Auto-merge para patches
- [ ] Security alerts

### Docker
- [ ] Criar `Dockerfile` multistage
- [ ] Criar `docker-compose.yml` para dev
- [ ] Publicar no Docker Hub
- [ ] Otimiza√ß√£o de tamanho

---

## üìä v3.1.5 - Testes Expandidos (Planned - Q4 2025)

> üìã **Vis√£o geral**: Ver [ROADMAP.md - v3.1.5](./ROADMAP.md#v315---testes-expandidos-planejado)

### Testes de Enriquecimento
- [ ] `tests/unit/test_normalizer.py`
  - Data/hora extraction e normaliza√ß√£o
  - Professor detection
  - URL extraction
  - Valida√ß√£o de formatos

- [ ] `tests/unit/test_classifier.py`
  - Detec√ß√£o de instru√ß√µes
  - Detec√ß√£o de autoestudos
  - Detec√ß√£o de ponderadas
  - Padr√µes regex

- [ ] `tests/unit/test_anchor.py`
  - Similaridade de t√≠tulos
  - Algoritmo de ancoragem
  - N√≠veis de confian√ßa
  - Multi-fator scoring

### Testes de Extra√ß√£o
- [ ] `tests/unit/test_card_extractor.py`
- [ ] `tests/unit/test_week_extractor.py`
- [ ] Mocks de Playwright responses
- [ ] Simula√ß√£o de elementos HTML

### Testes de Contrato
- [ ] `tests/unit/test_models.py`
  - Valida√ß√£o Pydantic de Card
  - Valida√ß√£o de EnrichedCard
  - Serializa√ß√£o/deserializa√ß√£o
  - Campos obrigat√≥rios

### CI/CD
- [ ] Integrar com GitHub Actions
- [ ] Badge de coverage no README
- [ ] Fail se coverage <70%
- [ ] Relat√≥rios HTML de cobertura

---

## üìã v3.2.0 - Configura√ß√£o e CLI Completa (Planned - Q1 2026)

> üìã **Vis√£o geral**: Ver [ROADMAP.md - v3.2.0](./ROADMAP.md#v320---configura√ß√£o-e-modos-de-execu√ß√£o-planejado)

### Interface CLI Completa
- [ ] Implementar Typer framework
- [ ] Comandos: `extract`, `resume`, `version`
- [ ] Argumentos: `--turma`, `--headless`, `--no-interactive`
- [ ] Flags: `--weeks`, `--frentes`, `--output`, `--format`

### Configura√ß√£o via Arquivo
- [ ] Suporte a `adalove.toml`
- [ ] Configura√ß√£o de extra√ß√£o, enriquecimento
- [ ] Override via CLI
- [ ] Valida√ß√£o de configura√ß√£o

### Integra√ß√£o com Agendadores
- [ ] Exemplos de cron/Task Scheduler
- [ ] Modo n√£o-interativo para automa√ß√£o
- [ ] Logs estruturados para monitoramento

---

## üìã v3.3.0 - Extra√ß√£o Seletiva (Planned - Q1 2026)

> üìã **Vis√£o geral**: Ver [ROADMAP.md - v3.3.0](./ROADMAP.md#v330---extra√ß√£o-seletiva-planejado)

### Extra√ß√£o de Semanas Espec√≠ficas
- [ ] Parser de express√µes de semanas (`1,3,7` ou `1-5`)
- [ ] Valida√ß√£o de semanas existentes
- [ ] Skip inteligente de semanas n√£o solicitadas
- [ ] Suporte a ranges e combina√ß√µes

### Extra√ß√£o de Frentes Espec√≠ficas
- [ ] Detec√ß√£o autom√°tica de frentes
- [ ] Mapeamento professor ‚Üí frente
- [ ] An√°lise de t√≠tulo do card (keywords)
- [ ] Suporte a m√∫ltiplas frentes

### Filtros Combinados
- [ ] Semanas + frentes espec√≠ficas
- [ ] Apenas autoestudos (`--only-autostudy`)
- [ ] Apenas atividades ponderadas (`--only-graded`)
- [ ] Exclus√£o de frentes (`--exclude-frentes`)

---

## üìã v3.4.0 - Interface Gr√°fica (GUI) (Planned - Q2 2026)

> üìã **Vis√£o geral**: Ver [ROADMAP.md - v3.4.0](./ROADMAP.md#v340---interface-gr√°fica-gui-planejado)

### Interface Principal
- [ ] Implementar com Tkinter (MVP)
- [ ] Layout: turma, semanas, frentes, op√ß√µes avan√ßadas
- [ ] Valida√ß√£o em tempo real
- [ ] Feedback visual de status

### Janela de Progresso
- [ ] Barra de progresso por semana
- [ ] Log em tempo real (scrollable)
- [ ] Estat√≠sticas atualizadas
- [ ] Bot√£o de cancelamento

### Sistema de Perfis
- [ ] Salvar/carregar configura√ß√µes
- [ ] Arquivo `~/.adalove/profiles.json`
- [ ] Exportar/importar perfis
- [ ] Perfil padr√£o

### Integra√ß√£o com CLI
- [ ] GUI gera comando CLI internamente
- [ ] Execu√ß√£o via subprocess
- [ ] Streaming de output
- [ ] Mostrar comando equivalente

---

## üîÆ v4.0.0 - Qualidade e Garantias (Planned - Q2 2026)

> üìã **Vis√£o geral**: Ver [ROADMAP.md - v4.0.0](./ROADMAP.md#v400---qualidade-e-garantias-planejado)

### Testes Unit√°rios Avan√ßados
- [ ] Estrutura completa de testes
- [ ] Fixtures com dados de exemplo
- [ ] Testes parametrizados
- [ ] Cobertura >80%

### Testes de Integra√ß√£o
- [ ] Fluxo completo com mocks
- [ ] Testes de performance
- [ ] Testes de stress
- [ ] Valida√ß√£o de outputs

### CI/CD Avan√ßado
- [ ] Pipeline completo
- [ ] Testes em m√∫ltiplas vers√µes Python
- [ ] Deploy autom√°tico
- [ ] Notifica√ß√µes

---

## üîÆ v4.1.0 - Observabilidade (Planned - Q3 2026)

> üìã **Vis√£o geral**: Ver [ROADMAP.md - v4.1.0](./ROADMAP.md#v410---observabilidade-planejado)

### Logs Estruturados
- [ ] Schema JSON Lines definido
- [ ] Rota√ß√£o de logs (7 dias ou 100MB)
- [ ] N√≠veis configur√°veis por m√≥dulo
- [ ] Output: arquivo + stdout

### M√©tricas de Execu√ß√£o
- [ ] Contadores: cards extra√≠dos, erros, retries
- [ ] Timers: tempo de extra√ß√£o, enriquecimento
- [ ] Distribui√ß√£o de confian√ßa
- [ ] Relat√≥rios formatados

### Integra√ß√£o com Ferramentas
- [ ] Elasticsearch/Kibana
- [ ] Grafana dashboards
- [ ] Sentry para rastreamento de erros
- [ ] Alertas autom√°ticos

---

## üîÆ v4.2.0 - Extensibilidade (Planned - Q3 2026)

> üìã **Vis√£o geral**: Ver [ROADMAP.md - v4.2.0](./ROADMAP.md#v420---extensibilidade-planejado)

### Plugin System
- [ ] Interface base `Plugin` (ABC)
- [ ] `EnrichmentPlugin` para enriquecimento
- [ ] `ExtractionPlugin` para extra√ß√£o
- [ ] Sistema de registro e carregamento

### Strategy Pattern
- [ ] `AnchorStrategy` para ancoragem
- [ ] Estrat√©gias: professor, data, t√≠tulo, posi√ß√£o
- [ ] Configura√ß√£o de pesos via TOML
- [ ] Estrat√©gias customiz√°veis

### Regras Configur√°veis
- [ ] Padr√µes de classifica√ß√£o
- [ ] Keywords para tipos de card
- [ ] Thresholds de confian√ßa
- [ ] Mapeamentos professor ‚Üí frente

---

## üêõ Bugs Conhecidos (Backlog T√©cnico)

### Alta Prioridade
- [ ] **Timeout em semanas com muitos cards (>50)**
  - Investigar: Aumentar timeout? Paralelizar?
  - M√≥dulo afetado: `extractors/week.py`
  - Solu√ß√£o: Implementar timeout din√¢mico

- [ ] **Cards sem data/hora quebram normaliza√ß√£o**
  - Adicionar fallback values
  - M√≥dulo afetado: `enrichment/normalizer.py`
  - Solu√ß√£o: Valores padr√£o para campos obrigat√≥rios

### M√©dia Prioridade
- [ ] **Professor n√£o detectado com m√∫ltiplos nomes**
  - Melhorar regex de detec√ß√£o
  - M√≥dulo afetado: `enrichment/normalizer.py`
  - Solu√ß√£o: Algoritmo de matching mais robusto

---

## üîß Melhorias T√©cnicas (Backlog)

### C√≥digo
- [ ] Completar type hints em `browser/navigator.py`
- [ ] Refatorar `enrich_cards()` (>100 linhas)
- [ ] Extrair magic numbers para `config/constants.py`
- [ ] Padronizar docstrings (Google style)

### Performance
- [ ] Profiling com cProfile
- [ ] Cache de elementos Playwright j√° visitados
- [ ] Avaliar paraleliza√ß√£o com `asyncio.gather()`
- [ ] Otimizar uso de mem√≥ria

### Documenta√ß√£o
- [ ] Exemplos avan√ßados no README
- [ ] FAQ de troubleshooting
- [ ] Mapear estrutura HTML do AdaLove
- [ ] Guias de contribui√ß√£o

---

## üìä An√°lise de Dados (Backlog)

- [ ] Notebook Jupyter: `notebooks/exploratory_analysis.ipynb`
- [ ] Script de relat√≥rios: `scripts/generate_report.py`
- [ ] Visualiza√ß√µes com matplotlib/plotly
- [ ] Dashboard com Streamlit (opcional)
- [ ] An√°lise de correla√ß√µes entre frentes e hor√°rios

---

**Legenda de Prioridades**:
- üî• URGENTE (v3.1.0)
- üìã Planejado (v3.1.x, v3.2.x, v3.3.x, v3.4.x)
- üîÆ Futuro (v4.x)
- üêõ Bug
- üîß Melhoria
- üìä An√°lise

---

**√öltima sincroniza√ß√£o entre ROADMAP.md e TODO.md**: 2025-10-16